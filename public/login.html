<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Iniciar sesión | AgroSky Costa Rica</title>
  <meta name="description" content="Acceso para administradores y pilotos de AgroSky" />
  <meta name="keywords" content="AgroSky, login, acceso" />

  <!-- Favicons -->
  <link href="assets/img/LogoVerdeOriginal.png" rel="icon" />
  <link href="assets/img/LogoVerde.png" rel="apple-touch-icon" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700;800&family=Poppins:wght@300;400;500;600;700;800;900&family=Jost:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />

  <!-- Vendor CSS Files (mismos que index) -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
  <link href="assets/vendor/aos/aos.css" rel="stylesheet" />
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet" />
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet" />

  <style>
    .login-wrapper { min-height: 60vh; display: grid; place-items: center; padding-top: 100px; padding-bottom: 60px; }
    .login-card { width: 100%; max-width: 480px; }
    .brand-mini { display:flex; align-items:center; gap:.5rem; text-decoration:none; }
    .brand-mini img { max-height: 40px; }
  </style>
</head>

<body class="index-page">
  <main class="main">
    <section class="login-wrapper">
      <div class="card shadow-lg border-0 rounded-4 login-card" data-aos="fade-up">
        <div class="card-body p-4 p-md-5">
          <div class="text-center mb-4">
  <a class="brand-mini mb-3 d-inline-block" href="index.html">
    <img src="assets/img/LogoVerde.png" alt="AgroSky" />
  </a>
  <h1 class="h4 mb-1">Acceso administrativo</h1>
  <p class="text-muted">Solo para administradores y pilotos.</p>
</div>

          <!-- FORM: ajusta action/method cuando tengas tu endpoint -->
          <form id="loginForm" method="POST" action="/api/auth/login" novalidate>
            <div class="mb-3">
              <label for="username" class="form-label">Identificación o correo</label>
              <input type="text" class="form-control" id="username" name="username" placeholder="admin@agroskycr.com" required />
              <div class="invalid-feedback">Ingresa tu identificación o correo.</div>
            </div>

            <div class="mb-2">
              <label for="password" class="form-label">Contraseña</label>
              <div class="input-group">
                <input type="password" class="form-control" id="password" name="password" placeholder="••••••••" required />
                <button class="btn btn-outline-secondary" type="button" id="togglePass" aria-label="Mostrar u ocultar contraseña">
                  <i class="bi bi-eye"></i>
                </button>
                <div class="invalid-feedback">Ingresa tu contraseña.</div>
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="remember" />
                <label class="form-check-label" for="remember"> Recordarme </label>
              </div>
              <!-- Enlace de recuperación (define tu flujo real) -->
              <a class="small" href="forms/forgot-password.html">¿Olvidaste tu contraseña?</a>
            </div>

            <div class="d-grid">
              <button class="btn-getstarted" type="submit">Ingresar</button>
            </div>

          </form>

          <hr class="my-4" />
          <p class="mb-0">
            ¿Necesitas volver al inicio?
            <a href="index.html">Ir a la página principal</a>
          </p>
        </div>
      </div>
    </section>
  </main>


  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center">
    <i class="bi bi-arrow-up-short"></i>
  </a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
  <script src="assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>

  <!-- Pequeño JS para validación y mostrar/ocultar contraseña -->
  <script>
    (function () {
      const form = document.getElementById('loginForm');
      const toggle = document.getElementById('togglePass');
      const pass = document.getElementById('password');

      toggle.addEventListener('click', () => {
        const isText = pass.type === 'text';
        pass.type = isText ? 'password' : 'text';
        toggle.innerHTML = isText ? '<i class="bi bi-eye"></i>' : '<i class="bi bi-eye-slash"></i>';
      });

      form.addEventListener('submit', (e) => {
        if (!form.checkValidity()) {
          e.preventDefault();
          e.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    })();
  </script>
  <script>
  // Mostrar alerta si viene ?error=...
  (function () {
    const params = new URLSearchParams(location.search);
    const err = params.get('error');
    if (err) {
      const msg = (err === '1')
        ? 'Credenciales inválidas. Verifica tu usuario y contraseña.'
        : 'No se pudo iniciar sesión. Intenta nuevamente.';

      const alert = document.createElement('div');
      alert.className = 'alert alert-danger mb-3';
      alert.role = 'alert';
      alert.textContent = msg;

      // Inserta la alerta arriba del formulario
      document.getElementById('loginForm').prepend(alert);
    }
  })();

  // (Opcional) recordar el usuario que escribió si hay error:
  (function () {
    const form = document.getElementById('loginForm');
    const user = document.getElementById('username');

    // al enviar, guarda el username por si redirige con error
    form.addEventListener('submit', () => {
      sessionStorage.setItem('last_login_username', user.value);
    });

    // al cargar, repone el username y limpia
    const last = sessionStorage.getItem('last_login_username');
    if (last) {
      user.value = last;
      sessionStorage.removeItem('last_login_username');
    }
  })();
</script>

</body>
</html>

